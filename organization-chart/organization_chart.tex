% Class diagram
% Author: Remus Mihail Prunescu
\documentclass{book}
\usepackage[a4paper,margin=1cm,landscape]{geometry}
\usepackage{tikz}
\usetikzlibrary{positioning,shapes,shadows,arrows}

\begin{document}
\tikzstyle{abstract}=[rectangle, draw=black, rounded corners, fill=orange!80, drop shadow,
        text centered, anchor=north, text=white, text width=3cm]


\tikzstyle{comment}=[rectangle, draw=black, rounded corners, fill=lightgray!30, drop shadow,
        text centered, anchor=north, text=black, text width=3cm]

\tikzstyle{myarrow}=[<-, >=open triangle 90, thick]


\tikzstyle{line}=[-, thick]
        
\begin{center}
\begin{tikzpicture}[node distance=2cm]
    %% PD
    \node (PD) [abstract, rectangle split, rectangle split parts=2]
        {
            \textbf{Y Lazarides}
            \nodepart{second}Project Director
        };

    \node (AuxNode01) [text width=4.0cm, below=of PD] {AUX};


    \node (Construction) [abstract, rectangle split, rectangle split parts=2, 
                                   fill= blue!40, left=of AuxNode01]
        {
            \textbf{Construction}
            \nodepart{second} Deputy PD
        };

%% Technical Office
    \node (System) [abstract, rectangle split, rectangle split parts=2, right=of AuxNode01]
        {
            \textbf{Technical Office}
            \nodepart{second} Shadi Al Ashkar
        };
    \node (AuxNode02) [text width=0.5cm, below=of Construction] {AUX2};







    \node (PM) [abstract, rectangle split, rectangle split parts=2, left=of AuxNode02]
        {
            \textbf{Mech. PM }
            \nodepart{second}Omar
        };
    \node (Part) [abstract, rectangle split, rectangle split parts=2, right=of AuxNode02]
        {
            \textbf{Elect. PM}
            \nodepart{second} Vacant
        };
        
    \node (AuxNode03) [text width=0.2cm, below=of PM] {AUX3};
    \node (Pressure) [abstract, rectangle split, rectangle split parts=2, left=of AuxNode03, xshift=2cm]
        {
            \textbf{Plumbing}
            \nodepart{second} Sripathy
        };
    \node (Temperature) [abstract, rectangle split, rectangle split parts=2, right=of AuxNode03, xshift=-2cm]
        {
            \textbf{VAC}
            \nodepart{second}Project Engineer\newline
                      Amar Asif
        };
    \node (PressureInstants) [comment, rectangle split, rectangle split parts=2, below=0.2cm of Pressure, text justified]
        {
            \textbf{Section Eng's.}
            \nodepart{second} W high-rise\newline 
                                       W-podia\newline 
                                       Westdene\newline 
                                      St. George\newline
                                      Subs. gas, water treatment\newline
				      Plantrooms\newline
        };
    \node (Fire) [abstract, rectangle split, rectangle split parts=2, below=0.4cm of PressureInstants]
        {
            \textbf{Fire Protection}
            \nodepart{second}nil
        };
    \node (ClOpInstants) [comment, rectangle split, rectangle split parts=2, below=0.2cm of Fire, text justified]
        {
            \textbf{Sub. Eng.\ref{firesub}}
            \nodepart{second}
                         Plantroom$^1$\newline 
                         W\newline
                         Westene\newline
                         St.George\newline
        };
    \node (TemperatureInstants) [comment, rectangle split, rectangle split parts=2, below=0.2cm of Temperature, text justified]
        {
            \textbf{Sections}
            \nodepart{second}W\newline Westene\newline St. George \newline Plant Rooms
        };
    \node (Level) [abstract, rectangle split, rectangle split parts=2, below=0.4cm of TemperatureInstants]
        {
            \textbf{Plantrooms}
            \nodepart{second}Nil
        };
    \node (LevelInstants) [comment, rectangle split, rectangle split parts=2, below=0.2cm of Level, text justified]
        {
            \textbf{Sect. Eng.}
            \nodepart{second} Towers\newline Podia
        };
    \node (Ammeter) [abstract, rectangle split, rectangle split parts=2, below=0.4cm of LevelInstants]
        {
            \textbf{Ammeter}
            \nodepart{second}nil
        };
    \node (AmmeterInstants) [comment, rectangle split, rectangle split parts=2, below=0.2cm of Ammeter, text justified]
        {
            \textbf{Instants}
            \nodepart{second}fw-pump-ammeter\newline sw-pump-ammeter
        };
        
    \node (AuxNode04) [below=of Part] {};
    \node (Pump) [abstract, rectangle split, rectangle split parts=2, left=of AuxNode04, xshift=2cm]
        {
            \textbf{Power}
            \nodepart{second}nil
        };
    \node (Valve) [abstract, rectangle split, rectangle split parts=2, right=of AuxNode04, xshift=-2cm]
        {
            \textbf{ELVs}
            \nodepart{second}nil
        };
    \node (PumpInstants) [comment, rectangle split, rectangle split parts=2, below=0.2cm of Pump, text justified]
        {
            \textbf{Instants}
            \nodepart{second}fw-pump\newline sw-pump
        };
    \node (Tank) [abstract, rectangle split, rectangle split parts=2, below=0.4cm of PumpInstants]
        {
            \textbf{Tank}
            \nodepart{second}nil
        };
    \node (ValveInstants) [comment, rectangle split, rectangle split parts=2, below=0.2cm of Valve, text justified]
        {
            \textbf{Instants}
            \nodepart{second}fw-suction-valve\newline fw-delivery-valve\newline sw-suction-valve\newline sw-delivery-valve
                \newline sw-discharge-valve\newline sw-control-valve
        };
    \node (Engine) [abstract, rectangle split, rectangle split parts=2, below=0.4cm of ValveInstants]
        {
            \textbf{Engine}
            \nodepart{second}nil
        };
    \node (TankInstants) [comment, rectangle split, rectangle split parts=2, below=0.2cm of Tank, text justified]
        {
            \textbf{Instants}
            \nodepart{second}fw-expansion-tank
        };
    \node (HeatExchanger) [abstract, rectangle split, rectangle split parts=2, below=0.4cm of TankInstants]
        {
            \textbf{Heat Exchanger}
            \nodepart{second}nil
        };
    \node (HeatExchangerInstants) [comment, rectangle split, rectangle split parts=2, below=0.2cm of HeatExchanger, text justified]
        {
            \textbf{Instants}
            \nodepart{second}fw-heat-exchanger
        };
    \node (EngineInstants) [comment, rectangle split, rectangle split parts=2, below=0.2cm of Engine, text justified]
        {
            \textbf{Instants}
            \nodepart{second}fw-engine
        };
    \node (Strainer) [abstract, rectangle split, rectangle split parts=2, below=0.4cm of HeatExchangerInstants]
        {
            \textbf{Strainer}
            \nodepart{second}nil
        };
    \node (StrainerInstants) [comment, rectangle split, rectangle split parts=2, below=0.2cm of Strainer, text justified]
        {
            \textbf{Instants}
            \nodepart{second}sw-strainer
        };
    \node (Coolant) [abstract, rectangle split, rectangle split parts=2, below=0.4cm of EngineInstants]
        {
            \textbf{Coolant}
            \nodepart{second}nil
        };
    \node (CoolantInstants) [comment, rectangle split, rectangle split parts=2, below=0.2cm of Coolant, text justified]
        {
            \textbf{Instants}
            \nodepart{second}fw-coolant\newline sw-coolant
        };  

    \node (AuxNode05) [below=of System] {};
    \node (CoolingSystem) [abstract, rectangle split, rectangle split parts=2, left=of AuxNode05, xshift=2cm]
        {
            \textbf{CAD Team}
            \nodepart{second}Indra Adnani
        };
    \node (CoolingLoop) [abstract, rectangle split, rectangle split parts=2, right=of AuxNode05, xshift=-2cm]
        {
            \textbf{Design Engineers}
            \nodepart{second}nil
        };

    \node (CADTeam) [comment, rectangle split, rectangle split parts=2, below=0.2cm of CoolingSystem, text justified]
        {
            \textbf{CAD Operators}
            \nodepart{second} HVAC \newline HVAC \newline HVAC \newline
        };

 \node (CADTeamElectrical) [comment, rectangle split, rectangle split parts=2, below=0.2cm of CADTeam, text justified]
        {
            \textbf{CAD Operators}
            \nodepart{second} HVAC \newline HVAC \newline HVAC \newline
        };
\node (CADTeamPlumbing) [comment, rectangle split, rectangle split parts=2, below=0.2cm of CADTeamElectrical, text justified]
        {
            \textbf{CAD Operators}
            \nodepart{second} HVAC \newline HVAC \newline HVAC \newline
        };

    \node (EngineeringSupport) [comment, rectangle split, rectangle split parts=2, below=0.2cm of CoolingLoop, text justified]
        {
            \textbf{}
            \nodepart{second}Mechanical\newline Electrical
									\newline Plumbing
									\newline ELV
        };
    
%% Commercial

\node (Commercial) [abstract, rectangle split, rectangle split parts=2, right=of System]
        {
            \textbf{Commercial Manager}
            \nodepart{second} 
        };

\node (Safety) [abstract, rectangle split, rectangle split parts=2, below=1.5cm of Commercial]
        {
            \textbf{HSE}
            \nodepart{second} 
        };

\node (QA) [abstract, rectangle split, rectangle split parts=2, below=of Safety]
        {
            \textbf{QA/QC}
            \nodepart{second} 
        };

\node (Admin) [abstract, rectangle split, rectangle split parts=2, below=of QA]
        {
            \textbf{Admin}
            \nodepart{second} 
        };
    \draw[myarrow] (Construction.north) -- ++(0,0.8) -| (PD.south);
    \draw[line] (Construction.north) -- ++(0,0.8) -| (System.north);
    
    \draw[myarrow] (PM.north) -- ++(0,0.8) -| (Construction.south);
    \draw[line] (PM.north) -- ++(0,0.8) -| (Part.north);
    
    \draw[line] (Pressure.west) -- ++(-0.2,0);
    \draw[line] (Temperature.east) -- ++(0.2,0);
    \draw[line] (Level.east) -- ++(0.2,0);
    \draw[myarrow] (Fire.west) -- ++(-0.2,0) -- ([yshift=0.5cm, xshift=-0.2cm] Pressure.north west) -|
     ([xshift=-1cm]PM.south);
    \draw[myarrow] (Ammeter.east) -- ++(0.2,0) -- ([yshift=0.5cm, xshift=0.2cm] Temperature.north east) -|
     ([xshift=1cm]PM.south);
     
    \draw[line] (Tank.west) -- ++(-0.2,0);
    \draw[line] (HeatExchanger.west) -- ++(-0.2,0);
    \draw[line] (Pump.west) -- ++(-0.2,0);
    \draw[line] (Valve.east) -- ++(0.2,0);
    \draw[line] (Engine.east) -- ++(0.2,0);
    \draw[myarrow] (Strainer.west) -- ++(-0.2,0) -- ([yshift=0.5cm, xshift=-0.2cm] Pump.north west) -|
     ([xshift=-1cm]Part.south);
    \draw[myarrow] (Coolant.east) -- ++(0.2,0) -- ([yshift=0.5cm, xshift=0.2cm] Valve.north east) -|
     ([xshift=1cm]Part.south);
     
    \draw[myarrow] (CoolingSystem.north) -- ++(0,0.8) -| (System.south);
    \draw[line] (CoolingSystem.north) -- ++(0,0.8) -| (CoolingLoop.north);
        
        
\end{tikzpicture}
\end{center}

\chapter{Narrative}
\section{Narrative}


Subcontractors \label{firesub}


\end{document}